{% extends "base.html" %}

{% block title %}{{ book.title }} - FreeWise{% endblock %}

{% block heading %}{% endblock %}

{% block content %}
<!-- Book Header (Centered) -->
<div style="text-align: center; margin-bottom: 30px; padding: 30px; background: var(--highlight-bg); border-radius: 8px; border: 1px solid var(--border-color);">
    <h1 style="margin: 0 0 15px 0; font-size: 2em; color: var(--text-color);">
        {{ book.title }}
    </h1>
    
    {% if book.author %}
    <div style="margin-bottom: 15px; font-size: 1.2em; color: var(--muted-text);">
        by {{ book.author }}
    </div>
    {% endif %}
    
    <!-- Document Tags Section -->
    <div id="document-tags-section" style="margin-top: 20px;">
        <div id="tags-list" style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-bottom: 10px;">
            {% if book.document_tags %}
                {% for tag in book.document_tags.split(',') %}
                <div style="display: inline-flex; align-items: center; padding: 6px 12px; background: var(--bg-color); border: 1px solid var(--border-color); border-radius: 20px;">
                    <span style="margin-right: 8px;">üè∑Ô∏è {{ tag.strip() }}</span>
                    <button 
                        style="background: transparent; border: none; cursor: pointer; color: #dc3545; padding: 0; font-size: 1.2em; line-height: 1;"
                        hx-post="/library/ui/book/{{ book.id }}/remove-tag"
                        hx-vals='{"tag": "{{ tag.strip() }}"}'
                        hx-target="#document-tags-section"
                        hx-swap="innerHTML"
                        title="Remove tag">
                        √ó
                    </button>
                </div>
                {% endfor %}
            {% endif %}
        </div>
        <div style="text-align: center;">
            <button 
                style="background: var(--bg-color); border: 1px dashed var(--border-color); padding: 8px 16px; border-radius: 20px; cursor: pointer; color: var(--muted-text);"
                hx-get="/library/ui/book/{{ book.id }}/add-tag"
                hx-target="#add-tag-form"
                hx-swap="innerHTML">
                + Add document tags
            </button>
        </div>
        <div id="add-tag-form" style="margin-top: 10px; text-align: center;"></div>
    </div>
    
    <div style="margin-top: 20px; color: var(--muted-text); font-size: 0.9em;">
        <strong>{{ highlights|length }}</strong> highlight{{ 's' if highlights|length != 1 else '' }} 
        ‚Ä¢ Added {{ book.created_at.strftime('%B %d, %Y') }}
    </div>
</div>

<!-- Highlights List -->
{% if highlights %}
<div id="highlights-container">
    {% for highlight in highlights %}
        {% include "_book_highlight.html" %}
    {% endfor %}
</div>
{% else %}
<div style="text-align: center; padding: 40px; background: var(--highlight-bg); border-radius: 8px; border: 1px solid var(--border-color);">
    <p style="font-size: 1.2em; margin-bottom: 10px;">No highlights yet</p>
    <p style="color: var(--muted-text);">Import highlights to get started.</p>
</div>
{% endif %}

<div style="margin-top: 30px; text-align: center;">
    <a href="/library/ui">‚Üê Back to Library</a>
</div>
{% endblock %}
