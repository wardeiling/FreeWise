<div class="highlight" id="highlight-{{ highlight.id }}" style="position: relative;">
    <div class="highlight-text">{{ highlight.text }}</div>
    
    {% if highlight.note %}
    <div class="highlight-source" style="font-style: italic; margin-top: 8px;">
        ðŸ’­ {{ highlight.note }}
    </div>
    {% endif %}
    
    <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 12px; flex-wrap: wrap; gap: 10px;">
        <div style="display: flex; gap: 10px; align-items: center;">
            <!-- Favorite Star -->
            <button 
                class="{% if highlight.favorite or highlight.is_favorited %}btn-favorite active{% else %}btn-favorite{% endif %}"
                hx-post="/highlights/{{ highlight.id }}/favorite"
                hx-vals='{"favorite": "{{ "false" if (highlight.favorite or highlight.is_favorited) else "true" }}", "context": "book"}'
                hx-target="#highlight-{{ highlight.id }}"
                hx-swap="outerHTML"
                title="Toggle favorite">
                {% if highlight.favorite or highlight.is_favorited %}â˜…{% else %}â˜†{% endif %}
            </button>
            
            <!-- Edit Button -->
            <button 
                class="btn-edit"
                hx-get="/highlights/{{ highlight.id }}/edit?context=book"
                hx-target="#highlight-{{ highlight.id }}"
                hx-swap="outerHTML"
                title="Edit highlight">
                âœŽ
            </button>
            
            <!-- Discard Toggle -->
            <button 
                class="btn-discard"
                hx-post="/highlights/{{ highlight.id }}/discard"
                hx-vals='{"context": "book"}'
                hx-target="#highlight-{{ highlight.id }}"
                hx-swap="outerHTML"
                hx-confirm="Are you sure you want to {{ 'restore' if highlight.is_discarded else 'discard' }} this highlight?"
                title="{{ 'Restore' if highlight.is_discarded else 'Discard' }} highlight">
                {% if highlight.is_discarded %}
                â†» Restore
                {% else %}
                âœ• Discard
                {% endif %}
            </button>
        </div>
        
        <!-- Status Badges -->
        <div style="display: flex; gap: 8px; align-items: center;">
            {% if highlight.is_discarded %}
            <span style="background: #dc3545; color: white; padding: 4px 10px; border-radius: 12px; font-size: 0.8em; font-weight: bold;">
                Discarded
            </span>
            {% endif %}
            <span style="color: var(--muted-text); font-size: 0.8em;">
                {{ highlight.created_at.strftime('%b %d, %Y') }}
            </span>
        </div>
    </div>
</div>
